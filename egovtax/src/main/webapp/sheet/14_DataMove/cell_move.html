<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	

<link rel="stylesheet" href="../../css/style.css"/>
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>
</head>

<script language="javascript">
	var pageheightoffset = 170;

	/*Sheet 기본 설정 */
	function LoadPage() {
		var initData = {};
		initData.Cfg = {SearchMode:2, Page:50,MergeSheet:msHeaderOnly,ChildPage:10,DragMode:1,DragCell:1	};
		initData.Cols = [
		{Header:"",Type:"Seq",  Width:35, Align:"Center"},
			{Header:"사원",Type:"Html", SaveName:"col1", Width:80, Align:"Center"},
			{Header:"주임",Type:"Html", SaveName:"col2", Width:80, Align:"Center"},
			{Header:"대리",Type:"Html", SaveName:"col3", Width:80, Align:"Center"},
			{Header:"과장",Type:"Html", SaveName:"col4", Width:80, Align:"Center"},
			{Header:"차장",Type:"Html", SaveName:"col5", Width:80, Align:"Center"},
			{Header:"부장",Type:"Html", SaveName:"col6", Width:80, Align:"Center"}
		];
		IBS_InitSheet(mySheet,initData);
		mySheet.FitColWidth();
		mySheet.SetDataRowHeight(104);

	}


		function mySheet_OnCellDropEnd(Obj, Row, Col, ToObj, ToRow, ToCol) {
			var bValue = ToObj.GetCellValue(ToRow, ToCol);
			var aValue = Obj.GetCellValue(Row, Col);

			if (ToRow < 0) {
				return;
				ToRow = ToObj.DataInsert(ToRow);
				ToCol = ToObj.MouseCol();
			}

			if (ToObj && ToRow > 0 && ToCol >= 0) {
				ToObj.SetCellValue(ToRow, ToCol, aValue);

				if (bValue) {
					Obj.SetCellValue(Row, Col, bValue);
				} else {
					Obj.SetCellValue(Row, Col, "");
				}
			}
}





	/*Sheet 각종 처리*/
	function doAction(sAction) {
		switch(sAction) {
			case "search":
				mySheet.DoSearch("cell_move_data.json");
			
				break;
			case "reload":
				mySheet.RemoveAll();
				break;
			case "save":      
				var str = mySheet.GetSaveString();
				alert(str);
				break;
			case "insert":
				mySheet.DataInsert(); 
				break; 
		}
	}

	
</script>

<body onLoad="LoadPage()">
        <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">데이터 이동 &gt; <b>셀 데이터 이동</b></span>
        </div>
                
        <div class="main_content">
            <div class="exp_product">
                사진이미지를 Drag&Drop 을 통해 이동해 본다.
            </div>
        
            <div class="ib_function float_right">
                <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
                <a href="javascript:doAction('search')" class="f1_btn_white gray">조회</a>
            </div>

			<div class="clear hidden"></div>  
            
            

			<p class="subtit_sheet">조회리스트</p>
			<DIV class="ib_product" style="width:100%;">
				<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
			</DIV>
          
    </div>
    <!--main_content-->

</body>
</html>








