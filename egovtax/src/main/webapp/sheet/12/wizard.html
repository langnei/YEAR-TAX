<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	

<link rel=stylesheet href="lib/codemirror.css">
<script src="lib/codemirror.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>

<style>
	fieldset {
  	padding: 1em;
  	font:1.1em sans-serif;
  	border:2px solid #9cb6cf
  }
legend {
  padding: 0.2em 0.5em;
  border:1px solid #9cb6cf;
  color:#565656;
  font-size:100%;
  text-align:left;
  }
  
.ulTable{display:table}
.liRow{display: table-row;float:left;padding:0 0 5px 0}
.liCellTitle{display: table-cell;font-weight:700;padding:0 1px 0 5px;
	font-family:dotum, Malgun Gothic, Arial, Helvetica, sans-serif;
	font-size:12px;
	}
.liCellContent{display: table-cell;padding:0 5px 0 1px;
	font-family:dotum, Malgun Gothic, Arial, Helvetica, sans-serif;
	font-size:12px;
	}

</style>
<script language="javascript">
	AutoResizeOff = true;
	
	String.prototype.trim = function() {
		return this.replace(/(^\s*)|(\s*$)/gi, "");
	}
	var browser = '';
	$(document).ready(function(){
		ChkBrowser();
		
		$(document).mousedown(function(e){
			$('#sourceText').each(function(){
				if( $(this).css('display') == 'block' )
				{
					var l_position = $(this).offset();
					l_position.right = parseInt(l_position.left) + ($(this).width());
					l_position.bottom = parseInt(l_position.top) + parseInt($(this).height());

					if( !(( l_position.left <= e.pageX && e.pageX <= l_position.right )
						&& ( l_position.top <= e.pageY && e.pageY <= l_position.bottom )) )
					{
						//$("#sourceText").hide();
					}
				}
			});
		}); 
	})
	
	function ChkBrowser(){
		var agt = navigator.userAgent.toLowerCase();
		if (agt.indexOf("chrome") != -1) browser = 'C'; 
		else browser = 'I';
	}
	

	/*Sheet 기본 설정 */
	function LoadPage() {
		var cfg = {SearchMode:smLazyLoad, Page:30, MergeSheet:msHeaderOnly};
		var headers = [
			{Text:"타이틀|컬럼ID|유형|수정\n가능\n여부|포멧|좌우\n정렬|너비|감추기|키필드|머지|줄넘김|트리|글자색|배경색|콤보\n텍스트|콤보\n코드|기본값|hidden", Align:"Center"}
		];
		var info = {HeaderCheck:1};
		var cols = [
			{Type:"Text", Width:"100",SaveName:"Title"},
			{Type:"Text", SaveName:"DataSaveName",Width:"100"},
			{Type:"Combo",SaveName:"DataType", ComboText:"텍스트(default)|상태|삭제|체크박스|라디오|콤보|콤보에디트|합계|평균|이미지|정수|실수|날짜|팝업|팝업에디트|패스워드|순번|Html|결과", ComboCode:"Text|Status|DelCheck|CheckBox|Radio|Combo|ComboEdit|AutoSum|AutoAvg|Image|Int|Float|Date|Popup|PopupEdit|Pass|Seq|Html|Result",PopupText:"Text|Status|DelCheck|CheckBox|Radio|Combo|ComboEdit|AutoSum|AutoAvg|Image|Int|Float|Date|Popup|PopupEdit|Pass|Seq|Html|Result", Width:"110"},
			{Type:"CheckBox", Width:"50", DefaultValue:true},
			{Type:"ComboEdit",SaveName:"DataFormat", ComboText:"포멧없음(default)|년월일|년월|월일|시분초|시분|년월일시분초|년월일시분|정수|널 정수|실수|널 실수|주민번호|사업자번호|우편번호|카드번호|전화번호|숫자형", ComboCode:"|Ymd|Ym|Md|Hms|Hm|YmdHms|YmdHm|Integer|NullInteger|Float|NullFloat|IdNo|SaupNo|PostNo|CardNo|PhoneNo|Number",PopupText:"|Ymd|Ym|Md|Hms|Hm|YmdHms|YmdHm|Integer|NullInteger|Float|NullFloat|IdNo|SaupNo|PostNo|CardNo|PhoneNo|Number", Width:"110"},
			{Type:"Combo", SaveName:"DataAlign",ComboText:"Left|Center|Right", ComboCode:"Left|Center|Right",PopupText:"Left|Center|Right", Width:"50"},
			{Type:"Int", SaveName:"DataWidth",Width:"60"},
			{Type:"CheckBox", Width:"70"},
			{Type:"CheckBox", Width:"70"},
			{Type:"CheckBox", Width:"70"},
			{Type:"CheckBox", Width:"70"},
			{Type:"Radio", Width:"50"},
			{Type:"PopupEdit", Width:"70"},
			{Type:"PopupEdit", Width:"70"},
			{Type:"Text", Width:"200"},
			{Type:"Text", Width:"200"},
			{Type:"Text", Width:"100"}
			
		];

		mySheet.SetConfig(cfg);
		mySheet.InitHeaders(headers,info);
		mySheet.InitColumns(cols);

		mySheet.SetHeaderBackColor("#C9E1F5");
		mySheet.SetSumBackColor("#E8F4FF");
		mySheet.SetEditEnterBehavior("down");
//		mySheet.FitSize(false,true);
	}




 function mySheet_OnChange(row,col,value){
 	var savename = mySheet.ColSaveName(0,col);
 	if(savename=="Title"){
	 	if(value.substring(0,2)=="상태" ||value.substring(0,3)=="상 태"){
					mySheet.SetCellValue(row,"DataType","Status");
					mySheet.SetCellValue(row,"DataSaveName","sStatus");
					mySheet.SetCellValue(row,"DataAlign","Center");
					mySheet.SetCellValue(row,"DataWidth","60");
					
			}else if(value.substring(0,2)=="No" ||value.substring(0,3)=="No."){
					mySheet.SetCellValue(row,"DataType","Seq");
					mySheet.SetCellValue(row,"DataSaveName","seq");
					mySheet.SetCellValue(row,"DataAlign","Center");
					mySheet.SetCellValue(row,"DataWidth","60");
			}else if(value.substring(value.length-1)=="일"){
					mySheet.SetCellValue(row,"DataType","Date");
					mySheet.SetCellValue(row,"DataFormat","Ymd");
					mySheet.SetCellValue(row,"DataAlign","Center");
					mySheet.SetCellValue(row,"DataWidth","100");
			}
 		}
 	}

	/*Sheet 각종 처리*/
	function doAction(sAction) {
		switch(sAction) {			
			case "insert":      //조회
//				removeInputArea();
				mySheet.RemoveAll();
				var col = $("#collength").val()*1;
				inputMake(col);
				break;				
			case "make":     
				var text = codegenerate();				
				$("#sourceText").css('display','');				
				var obj = $('#sourceText');
				var iHeight = (document.body.clientHeight / 2) - obj.height() / 2 + document.body.scrollTop;
				var iWidth = (document.body.clientWidth / 2) - obj.width() / 2 + document.body.scrollLeft;

				$("#sourceText").css("top",iHeight);
				$("#sourceText").css("left",iWidth);
				editor.setValue(text);
				break;			
		}
	}
	
	function codegenerate(){
		//cfg
		var autoclosedialog = $("input:checkbox[id='autoclosedialog']").is(":checked");
		var childpage = $("#childpage").val().trim();
		var combomaxheight = $("#combomaxheight").val().trim();
		var datarowmerge = $("input:checkbox[id='datarowmerge']").is(":checked");
		var dragcell = $("input:checkbox[id='dragcell']").is(":checked");
		var dragmode = $("select[id=dragmode]").val().trim();
		var frozencol = $("#frozencol").val().trim();
		var headercheckmode = $("input:checkbox[id='headercheckmode']").is(":checked");
		var headermergemode = $("input:checkbox[id='headermergemode']").is(":checked");
		var keyfieldposition = $("select[id=keyfieldposition]").val().trim();
		var maxsort = $("#maxsort").val().trim();
		var mergesheet = $("select[id=mergesheet]").val();
		var newrowdeletemode = $("input:checkbox[id='newrowdeletemode']").is(":checked");
		var page = $("#page").val().trim();
		var searchmode = $("select[id=searchmode]").val();
		var sizemode = $("select[id=sizemode]").val();
		var smartresize = $("input:checkbox[id='smartresize']").is(":checked");
		var sorteventmode = $("input:checkbox[id='sorteventmode']").is(":checked");
		var sumposition = $("input:checkbox[id='sumposition']").is(":checked");
		var tooltip = $("input:checkbox[id='tooltip']").is(":checked");
		var touchscrolling = $("select[id=touchscrolling]").val();
		var useheaderactionmenu = $("input:checkbox[id='useheaderactionmenu']").is(":checked");
		var usenodatarow = $("select[id=usenodatarow]").val();
		var vscrollmode = $("select[id=vscrollmode]").val();
		var nextpagecall = $("#nextpagecall").val().trim();
		
		var text = "var ibsheet = {};\n\n";
		text = text + "";
		text = text +  "ibsheet.Cfg={";
		text += "\n\t SearchMode:"+searchmode;
		if(autoclosedialog)	text += ",\n\t AutoCloseDialog:"+autoclosedialog;
		if(childpage != "0" && childpage != "") text += ",\n\t ChildPage:"+childpage;
		if(combomaxheight != "" && combomaxheight != "") text += ",\n\t ComboMaxHeight:"+combomaxheight;
		if(datarowmerge) text += ",\n\t DataRowMerge:"+datarowmerge;
		if(dragcell) text += ",\n\t DragCell:"+dragcell;
		if(dragmode != "0" && dragmode != "") text += ",\n\t DragMode:"+dragmode;
		if(frozencol != "0" && frozencol != "") text += ",\n\t FrozenCol:"+frozencol;
		if(headercheckmode) text += ",\n\t HeaderCheckMode:"+headercheckmode;
		if(headermergemode) text += ",\n\t HeaderMergeMode:"+headermergemode;
		if(keyfieldposition != "Left") text += ",\n\t KeyFieldPosition:"+keyfieldposition;
		if(maxsort != "3" && maxsort != "") text += ",\n\t MaxSort:"+maxsort;
		if(mergesheet != "0" && mergesheet != "") text += ",\n\t MergeSheet:"+mergesheet;
		if(newrowdeletemode) text += ",\n\t NewRowDeleteMode:"+newrowdeletemode;		
		if(page != "20" && page != "") text += ",\n\t Page:"+page;
		if(sizemode != "0" && sizemode != "") text += ",\n\t SizeMode:"+sizemode;
		if(smartresize) text += ",\n\t SmartResize:"+smartresize;
		if(sorteventmode) text += ",\n\t SortEventMode:"+sorteventmode;
		if(sumposition != "1" && sumposition != "") text += ",\n\t SumPosition:"+sumposition;
		if(tooltip) text += ",\n\t ToolTip:"+tooltip;
		if(touchscrolling != "1" && touchscrolling != "") text += ",\n\t TouchScrolling:"+touchscrolling;
		if(useheaderactionmenu) text += ",\n\t UseHeaderActionMenu:"+useheaderactionmenu;
		if(usenodatarow != "1" && usenodatarow != "") text += ",\n\t UseNoDataRow:"+usenodatarow;
		if(vscrollmode != "0" && vscrollmode != "") text += ",\n\t VScrollMode:"+vscrollmode;
		if(nextpagecall != "0" && nextpagecall != "") text += ",\n\t NextPageCall:"+nextpagecall;
		text += "\n};";
		
		//header
		
		var headersort = $("input:checkbox[id='sort']").is(":checked");
		var colmove = $("input:checkbox[id='colmove']").is(":checked");
		var colresize = $("input:checkbox[id='colresize']").is(":checked");
		var headercheck = $("input:checkbox[id='headercheck']").is(":checked");
		
		text = text + "\n\nibsheet.Header = {" 
			+"\n\t Sort:"+headersort
			+",\n\t ColMove:"+colmove
			+",\n\t ColResize:"+colresize
			+",\n\t HeaderCheck:"+headercheck
			+"\n};";
		
		text = text + "\n\nibsheet.Cols = [ " 
		
		for(var cnt=1, maxrow=mySheet.LastRow();cnt <= maxrow;cnt++){
			var sHeader = '"' + mySheet.GetCellValue(cnt,"Title").trim() + '"';
			var sSaveName = '"' + mySheet.GetCellValue(cnt,1).trim() + '"';
			var sType = '"' + mySheet.GetCellValue(cnt,2 ).trim() + '"';
			var sEdit = mySheet.GetCellValue(cnt,3 );
			var sFormat = '"' + mySheet.GetCellValue(cnt,4 ).trim() + '"';
			var sAlign = '"' + mySheet.GetCellValue(cnt,5 ).trim() + '"';
			var sWidth = mySheet.GetCellValue(cnt,6 );
			var sHidden = mySheet.GetCellValue(cnt,7 );
			var sKeyField = mySheet.GetCellValue(cnt,8 );
			var sColMerge = mySheet.GetCellValue(cnt,9 );
			var sMultiLineText = mySheet.GetCellValue(cnt,10);
			var sTreeCol = mySheet.GetCellValue(cnt,11).trim();
			var sFontColor = '"' + mySheet.GetCellValue(cnt,12).trim() + '"';
			var sBackColor = '"' + mySheet.GetCellValue(cnt,13).trim() + '"';
			var sComboCode = '"' + mySheet.GetCellValue(cnt,14).trim() + '"';
			var sComboText = '"' + mySheet.GetCellValue(cnt,15).trim() + '"';
			var sDefaultValue = '"' + mySheet.GetCellValue(cnt,16).trim() + '"';
			
			text = text + "\n {";
			text += " Header: " + sHeader;
			text += ", Type: " + sType;
			if(sSaveName != null && sSaveName != "" && sSaveName != '""') text += ", SaveName: " + sSaveName;			
			text += ", Edit: " + sEdit;
			if(sFormat != null && sFormat != "" && sFormat != '""') text += ", Format: " + sFormat;
			text += ", Align: " + sAlign;
			if(sWidth != null && sWidth != "" && sWidth != '""')	text += ", Width: " + sWidth;			
			text += ", Hidden: " + sHidden;
			text += ", KeyField: " + sKeyField;
			text += ", ColMerge: " + sColMerge;
			text += ", MultiLineText: " + sMultiLineText;
			text += ", TreeCol: " + sTreeCol;
			if(sFontColor != null && sFontColor != "" && sFontColor != '""') text += ", FontColor: " + sFontColor;
			if(sBackColor != null && sBackColor != "" && sBackColor != '""') text += ", BackColor: " + sBackColor;
			if(sComboCode != null && sComboCode != "" && sComboCode != '""') text += ", ComboCode: " + sComboCode;
			if(sComboText != null && sComboText != "" && sComboText != '""') text += ", ComboText: " + sComboText;
			if(sDefaultValue != null && sDefaultValue != "" && sDefaultValue != '""') text += ", DefaultValue: " + sDefaultValue;
			text += "}";
			if((cnt+1) <= maxrow) text = text + ",";
			
		}
		
		text = text + "\n];\n\n";
		
		text = text + "IBS_InitSheet(mySheet, ibsheet);";
		
		return text;
	}
	
//	function removeInputArea(){
//		var table_id = document.getElementById('table_id');
//		var row = table_id.rows.length;
//	
//		for(i=0 ; i<row ; i++) {
//			table_id.deleteRow();
//		}
//	}
	
	function hideDiv(){
		$("#sourceText").hide();
	}

	
	
	function inputMake(col){

		for(var k=1; k <= col; k++){
			mySheet.DataInsert();
		}
		//sheetSize();
	}
	
	function chgColumn(j, i){
		var text = '';
		var k=1, cnt = 1;
		if(browser == 'I'){
			text = document.getElementById("col_"+i+"_"+j).value;
		}else{
			text = document.getElementById("col_1"+"_"+j).value;
			k=i;
			cnt=-1;
		}
		mySheet.SetCellValue(j, 0, text);
		
		if(text=="상태" ||text=="상 태"){
				mySheet.SetCellValue(j,"DataType","Status");
				mySheet.SetCellValue(j,"DataSaveName","sStatus");
				mySheet.SetCellValue(j,"DataAlign","Center");
				mySheet.SetCellValue(j,"DataWidth","60");
				
		}else if(text=="No" ||text=="No."){
				mySheet.SetCellValue(j,"DataType","Seq");
				mySheet.SetCellValue(j,"DataSaveName","seq");
				mySheet.SetCellValue(j,"DataAlign","Center");
				mySheet.SetCellValue(j,"DataWidth","60");
		}else if(text.substring(text.length-1)=="일"){
				mySheet.SetCellValue(j,"DataType","Date");
				mySheet.SetCellValue(j,"DataFormat","Ymd");
				mySheet.SetCellValue(j,"DataAlign","Center");
				mySheet.SetCellValue(j,"DataWidth","100");
		}
		
//		mySheet.FitSize(false,true);
		
		
		var hiddentext = "";	
		
		while(1){
			hiddentext = hiddentext + document.getElementById("col_"+k+"_"+j).value + "|";			
			k = k+ cnt;
			if(browser == 'I' && k > i)	break;	
			else if(browser == 'C' && k == 0)	break;
		}
		hiddentext = hiddentext.substring(0, hiddentext.length-1);
		mySheet.SetCellValue(j,17,hiddentext);
	}
	
	var poprow=0;
	var popcol=0;
	function mySheet_OnPopupClick(Row, Col){
		poprow = Row;
		popcol = Col;
		window.open("color.html","_blank","width=260, height=220");
	}
	
	function setColor(txt){
		mySheet.SetCellValue(poprow, popcol, txt);
	}
	

</script>
<style>
  .CodeMirror { height: 450px; border: 1px solid #ddd; }
  .CodeMirror-scroll { max-height: 600px; }
  .CodeMirror pre { padding-left: 7px; line-height: 1.25; }
</style>
</head>
<body onLoad="LoadPage()" style="height:100%;overflow-y:auto">
        <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">위자드 > <b>시트생성</b></span>
        </div>
                
        <div class="main_content">


			<div class="clear hidden"></div>  
           
			<!-- SetConfig 영역 -->
            <fieldset>
				<legend>SetConfig</legend>
				
				
				
<ul class="ulTable">
  <li class="liRow">
    <ul>
      <li title="조회 방식 설정" class="liCellTitle">조회방식</li>
      <li class="liCellContent">
				<select id="searchmode" class="selectbox" style="width:100px;">
					<option value="smGeneral">일반조회 모드</option>
					<option value="smClientPaging">페이징 모드</option>
					<option value="smLazyLoad" selected>LazyLoad 모드</option>
					<option value="smServerPaging">실시간 서버 처리 모드</option>
				</select>
			</li>
      <li class="liCellTitle"  title="한번에 표시할 행의 개수">페이지수</li>
      <li class="liCellContent"><input type="text" id="page" value="20" size="5" class="inputbox"/></li>
      <li class="liCellTitle" title="콤보목록, 달력팝업, 액션메뉴 팝업의 자동닫기 여부 설정">자동닫기</li>
      <li class="liCellContent"><input type="text" id="childpage" value="0" size="5" class="inputbox"/></li>
    </ul>
  </li>    
    
  <li class="liRow">
    <ul>
    	<li class="liCellTitle" title="좌측 고정컬럼의 수">좌측컬럼고정</li>
      <li class="liCellContent"><input type="text" id="frozencol" value="0" size="5" class="inputbox"/></li>
     	<li class="liCellTitle" title="머지종류">머지종류</li>
      <li class="liCellContent">
  				<select id="mergesheet" class="selectbox">
						<option value="msNone" selected>머지없음</option>
						<option value="msAll">전부머지</option>
						<option value="msPrevColumnMerge">앞컬럼머지</option>
						<option value="msHeaderOnly">헤더만머지</option>
						<option value="msPrevColumnMerge+msHeaderOnly">앞컬럼+헤더머지</option>
						<option value="msFixedMerge">다중라인레코드 머지</option>
					</select>
			</li>
    	<li class="liCellTitle" title="콤보목록, 달력팝업, 액션메뉴 팝업의 자동닫기 여부 설정">자동닫기</li>
      <li class="liCellContent"><input class="checkbox" type="checkbox" id="autoclosedialog" /></li>
    </ul>
  </li>
    <li class="liRow">
    <ul>
    	<li class="liCellTitle" title="콤보리스트 최대 높이 설정">콤보높이</li>
      <li class="liCellContent"><input type="text" id="combomaxheight" value="" size="5" class="inputbox"/></li>
     	<li class="liCellTitle" title="전체행의 가로머지 혀용여부">데이터머지</li>
      <li class="liCellContent"><input class="checkbox" type="checkbox" id="datarowmerge" /></li>
    	<li class="liCellTitle" title="드래그시 셀 단위 드래그 여부 설정">셀드래그</li>
      <li class="liCellContent"><input class="checkbox" type="checkbox" id="dragcell" /></li>
    </ul>
  </li>
    <li class="liRow">
    <ul>
    	<li class="liCellTitle" title="드래그 처리 방법">드래그처리</li>
      <li class="liCellContent">
				<select id="dragmode" class="selectbox">
					<option value="-1" title="드래그 사용안함">사용안함</option>
					<option value="0" title="셀 또는 행 범위 셀렉션, Ctrl 키 이용 : 행 드래깅" selected>일반</option>
					<option value="1" title="일반 : 행 드래깅, Ctrl  키 이용 : 셀 또는 행 범위 샐렉션">행 드래그</option>
				</select>
      </li>
     	<li class="liCellTitle">헤더체크</li>
      <li class="liCellContent"><input class="checkbox" type="checkbox" id="headercheckmode" /></li>
    	<li class="liCellTitle">헤더머지</li>
      <li class="liCellContent"><input class="checkbox" type="checkbox" id="headermergemode" /></li>
    </ul>
  </li>
    <li class="liRow">
    <ul>
    	<li class="liCellTitle" title="필수 입력 표시 위치 설정">필수입력위치</li>
      <li class="liCellContent">
				<select id="keyfieldposition" class="selectbox">
					<option value="Left" title="헤더텍스트의 왼쪽" selected>왼쪽</option>
					<option value="Right" title="헤더텍스트의 오른쪽">오른쪽</option>
				</select>
			</li>
     	<li class="liCellTitle" title="헤더클릭을 이용한 연계 소팅 최대 개수를 설정">최대정렬</li>
      <li class="liCellContent"><input type="text" id="maxsort" value="3" size="5" class="inputbox"/></li>
    	<li class="liCellTitle" title="신규행 삭제시 confirm 창을 띄운다">신규행삭제</li>
      <li class="liCellContent"><input class="checkbox" type="checkbox" id="nextrowdeletemode" /></li>
    </ul>
  </li>
  <li class="liRow">
    <ul>
    	<li class="liCellTitle" title="조회 모드가 서버페이징, LazyLoad 방식인 경우 다음 페이지를 호출하는 시점설정(60~90)">페이지호출</li>
      <li class="liCellContent"><input type="text" id="nextpagecall" value="" size="5" class="inputbox"/></li>
     	<li class="liCellTitle">SizeMode</li>
      <li class="liCellContent">
	      <select id="sizemode" class="selectbox">
					<option value="sizeAuto" title="설정한 높이 그대로사용" selected>sizeAuto</option>
					<option value="sizeNoVScroll" title="높이를 스크롤 없이 자동 설정, 생성시 설정한 높이값은 무시된다">sizeNoVScroll</option>
					<option value="sizeNoHScroll" title="너비를 스크롤 없이 자동 설정, 생성시 설정한 너비값은 무시된다">sizeNoHScroll</option>
					<option value="sizeNoBothScroll" title="높이,너비 모두 스크롤 없이 자동설정, 생성시 설정한 높이, 너비값은 무시된다.">sizeNoBothScroll</option>
				</select>	
      </li>
    	<li class="liCellTitle" title="Smart Resize">자동조정</li>
      <li class="liCellContent"><input class="checkbox" type="checkbox" id="smartresize" /></li>
    </ul>
  </li>
  <li class="liRow">
    <ul>
    	<li class="liCellTitle" title="헤더클릭을 이용한 연계 소팅 최대 개수를 설정">정렬이벤트</li>
      <li class="liCellContent"><input class="checkbox" type="checkbox" id="sortevent" /></li>
     	<li class="liCellTitle" title="합계행위치">합계행위치</li>
      <li class="liCellContent">
				<select id="sumposition" class="selectbox">
					<option value="posTop">상단고정</option>
					<option value="posBottom" selected>하단고정</option>
				</select>	
      </li>
    	<li class="liCellTitle">툴팁여부</li>
      <li class="liCellContent"><input class="checkbox" type="checkbox" id="tooltip" /></li>
    </ul>
  </li>
  <li class="liRow">
    <ul>
    	<li class="liCellTitle">터치스크롤</li>
      <li class="liCellContent">
	      <select id="touchscrolling" class="selectbox">
					<option value="0">사용안함</option>
					<option value="1" selected>일반사용</option>
					<option value="2">지연이동</option>
				</select>	
      </li>
     	<li class="liCellTitle">헤더액션메뉴</li>
      <li class="liCellContent"><input class="checkbox" type="checkbox" id="useheaderactionmenu" /></li>
    	<li class="liCellTitle">데이터없을시</li>
      <li class="liCellContent">
      	<select id="usenodatarow" class="selectbox">
					<option value="0">사용안함</option>
					<option value="1" selected>사용</option>
				</select></li>
    </ul>
  </li>
  <li class="liRow">
    <ul>
    	<li class="liCellTitle">세로스크롤</li>
      <li class="liCellContent">
      	<select id="vscrollmode" class="selectbox">
					<option value="0" selected>자동</option>
					<option value="1">고정</option>
				</select></li>
     	<li class="liCellTitle"></li>
      <li class="liCellContent"></li>
    	<li class="liCellTitle"></li>
      <li class="liCellContent"></li>
    </ul>
  </li>
  <!--
  <li class="liRow">
    <ul>
    	<li class="liCellTitle"></li>
      <li class="liCellContent"></li>
     	<li class="liCellTitle"></li>
      <li class="liCellContent"></li>
    	<li class="liCellTitle"></li>
      <li class="liCellContent"></li>
    </ul>
  </li>
  -->
</ul>
				
           </fieldset>
           
           
           
           
           
           
		   <div style="width:100%;height:5px"></div>
			<!-- InitHeaders 영역 -->
      <fieldset>
				<legend>InitHeaders</legend>
				<table class="ib_column2">
					<tr>
						<th class="tit" title="">헤더소트</th>
						<td class="r20"><input class="checkbox" type="checkbox"  checked id="sort" /></td>	
						<th class="tit" title="">컬럼이동</th>
						<td class="r20"><input class="checkbox" type="checkbox" checked id="colmove" /></td>
						<th class="tit" title="">컬럼Resize</th>
						<td class="r20"><input class="checkbox" type="checkbox" checked id="colresize" /></td>
						<th class="tit" title="">헤더전체체크</th>
						<td class="r20"><input class="checkbox" type="checkbox" checked id="headercheck" /></td>
                        <!--td class="r20"><a href="javascript:doAction('down2excel');" class="f2_btn_white btn_sheet" style="width:80px">엑셀다운</a></td-->
					
						<th class="tit" title="">컬럼 갯수</th>
						<td class="r20"><input type="text" id="collength" style="border-color:#FF0000" value="5" size="5" class="inputbox"/></td>
						
						<td class="r20">
							<a href="javascript:doAction('insert');" class="f2_btn_white btn_sheet" style="width:80px">1. 컬럼 생성</a>
							<a href="javascript:doAction('make')" class="f2_btn_white btn_sheet">2. 소스생성</a>
							
							</td>
					 </tr>
				</table>
      </fieldset>
      <div style="width:100%;height:5px"></div>
<!--		  
		  <fieldset>
		  	<legend>헤더 타이틀</legend>
			  <table class="ib_column2" id="table_id">
					
			  </table>
			</fieldset>
			-->
			<p class="subtit_sheet">조회리스트</p>
            <div class="ib_product" id="sheetDiv">
				<script type="text/javascript"> 
//					var sh = $(window).height()-document.getElementById("sheetDiv").getBoundingClientRect().top-100;
//					if(sh < 83) sh = 200;
					createIBSheet("mySheet", "100%", "250px"); 
				</script>
            </div>
        </div>
        <!--main_content-->
		
		<div id="sourceText" style="position:absolute;z-index:300;display:none;width:700px;height:490px;background-color:#CCCCCC">
			<div id="btnArea" style="position:absolute;right:5px;"><a href="javascript:hideDiv()"><img src="../../common/img/x.png" /></a></div>
			<div id="contentsArea" style="position:absolute;left:5px;top:25px;width:690px; height:460px;">
				<form style="position: relative; margin-top: .5em;">
					<textarea id="area"></textarea>
				  </form>
				  <script>
					var editor = CodeMirror.fromTextArea(document.getElementById("area"), {
					  lineNumbers: true,
					  lineWrapping:true,
					  mode: "javascript",
					  matchBrackets: true
					});
				  </script>  
			</div>
		</div>
	
</body>

</html>