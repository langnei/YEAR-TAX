<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/speed/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/speed/ibsheet.js"></script>
<script language="javascript" src="../../common/js/jquery.blockUI.js"></script>
<title>IBSheet7-Product</title>
</head>

<script language="javascript">
	
	var pageheightoffset = 240;
	/*Sheet 기본 설정 */
	function LoadPage() {
		var cfg = {SearchMode:smClientPaging, Page:100, MergeSheet:msNone,MaxSort:1};
		var headers = [ {Text:"No|사원번호|성|이름|성별|시작일|종료일|부서코드|부서명|생일|고용일", Align:"Center"} ];
		var info = {Sort:1,ColMove:1,ColResize:1,HeaderCheck:1};
		var cols = [
					{Type:"Seq",Width:45,SaveName:"RN",Align:"center"},
        	{Type:"Text",Width:85,Align:"Center",SaveName:"EMP_NO"},
        	{Type:"Text",Width:70,SaveName:"FIRST_NAME"},
        	{Type:"Text",Width:80,SaveName:"LAST_NAME"},
        	{Type:"Combo",Width:80,Align:"Center",SaveName:"gender",ComboText:"남자|여자",ComboCode:"M|F"},
        	{Type:"Date",Width:80,Align:"Center",SaveName:"FROM_DATE"},
        	{Type:"Date",Width:80,Align:"Center",SaveName:"TO_DATE"},
        	{Type:"Text",Width:80,Align:"Center",SaveName:"DEPT_NO"},
        	{Type:"Text",Width:80,Align:"Center",SaveName:"DEPT_NAME"},
        	{Type:"Date",Width:80,Align:"Center",SaveName:"BIRTH_DATE",Format:"Ymd"},
        	{Type:"Date",Width:80,Align:"Center",SaveName:"HIRE_DATE",Format:"Ymd"},
        	{Type:"Status",SaveName:"sStatus",Hidden:1}
		];

		mySheet.SetConfig(cfg);
		mySheet.InitHeaders(headers,info);
		mySheet.InitColumns(cols);
		mySheet.SetDataAutoTrim(0);
    mySheet.SetFocusAfterProcess(0);
    mySheet.ShowFilterRow();
		mySheet.SetCountPosition(4);
		mySheet.SetPagingPosition(1);
		mySheet.FitColWidth();
		

	}

	/*Sheet 각종 처리*/
	function doAction(sAction) {
	  switch(sAction) {
		case "search":      //조회
			mySheet.SetWaitImageVisible(0);		
			startTime = new Date();
				$.blockUI({ message: "<h3 style='padding-top:2px'> 검색 중 입니다.</h3><div style='height:10px;border:1px solid #449944'><div id='progress' style='width:0%;height:100%;background-color:#449944'></div></div><div style='height:3px'></div>" });
      	var param = "cnt="+document.getElementById("cnt").value+"&ibpage=1&onepagerow=30000";
  			mySheet.DoSearch("speedtest_data_employees.jsp",param,{Sync:1,Fx:1});
      break;
    case "reload":
		mySheet.RemoveAll();
		break;
		case "save":
			alert(mySheet.GetSaveString());
		break;
		}
	}
	var pageNo = 1;
	function mySheet_OnSearchEnd(code,msg){
		
			if(code==-1){
				alert(msg);	
			}
			
			total = mySheet.GetTotalRows();
			var w = 0;
			if(mySheet.SearchRows()<total){
				w = Math.abs((mySheet.SearchRows()/mySheet.GetTotalRows())*100); 
				document.getElementById("progress").style.width = w +"%";
				pageNo ++;
				var param = "ibpage="+pageNo+"&onepagerow=30000&cnt="+total;
				mySheet.DoSearch("speedtest_data_employees.jsp",param,{ Sync:1,Fx:1,Append : 1 });	
			}else{
				$.unblockUI();
				mySheet.SetWaitImageVisible(1);		
				var endTime = new Date();
				document.getElementById("searchTime").value = (endTime-startTime)/1000;
			}
			
	}


</script>

<body onload="LoadPage()">
        <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">데이터조회 &gt; <b>조회속도</b></span>
        </div>
                
        <div class="main_content">
            <div class="exp_product">
                조회 건수에 따른 처리 속도를 확인 한다.
            </div>
        
            <div class="ib_function float_right">
                <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
                <a href="javascript:doAction('search')" class="f1_btn_white gray">조회</a>
                <a href="javascript:doAction('save')" class="f1_btn_white gray">저장</a>
            </div>

			<div class="clear hidden"></div>  
            
            <div class="ib_function2 border_sheet">
				<table class="ib_column2">
					<tr>
						
						<td class="r20">조회건수</td>
						<td>
							<select id="cnt">
          			<option value="3000">3,000</option>
          			<option value="6000">6,000</option>
          			<option value="10000">10,000</option>
          			<option value="50000">50,000</option>
          			<option value="100000">100,000</option>
          			<option value="-1">All</option>
          		</select>
          	</td>
						 <td class="r20" style="width:100px">경과 시간</td>
            <td>
            		<input type="text" id="searchTime" readonly style="width:55px;text-align:right;border:0 0 0 0"> 초
            </td>
					 </tr>
				</table>
           </div>

			<p class="subtit_sheet">조회리스트</p>
            <div class="ib_product">
				<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
            </div>
        </div>
        <!--main_content-->

</body>
</html>








