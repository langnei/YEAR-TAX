<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>
</head>

<script language="javascript">
	
	var pageheightoffset = 170;
	/*Sheet 기본 설정 */
	function LoadPage() {
		var cfg = {SearchMode:smServerPaging, Page:100, MergeSheet:msNone};
		var headers = [ {Text:"No|우편번호|시도|시군구|읍면동|리|주소", Align:"Center"} ];
		var info = {Sort:1,ColMove:1,ColResize:1,HeaderCheck:1};
		var cols = [
					{Type:"Text",Width:45,SaveName:"RN",Align:"center",ColMerge:0},
		        	{Type:"Text",Width:85,Align:"Center",SaveName:"POSTNO",Format:"PostNo",ColMerge:0},
		        	{Type:"Text",Width:70,SaveName:"SIDO"},
		        	{Type:"Text",Width:80,SaveName:"SIGUNGU",Sort:0},
		        	{Type:"Text",Width:80,SaveName:"UBMYNDONG"},
		        	{Type:"Text",Width:80,SaveName:"LEE"},
		        	{Type:"Text",Width:300,SaveName:"ADDRESS"}
		];

		mySheet.SetConfig(cfg);
		mySheet.InitHeaders(headers,info);
		mySheet.InitColumns(cols);

		mySheet.SetEditable(0);
		mySheet.SetCountPosition(4);
		mySheet.FitColWidth();
		
	}
	function mySheet_OnBeforeSearch(){
		if(mySheet.ACol){
			var param = mySheet.Data.Data.fD;
			
			
		}
	}
	/*Sheet 각종 처리*/
	function doAction(sAction) {
		switch(sAction) {
			case "search":      //조회
				var param = {"Param":"onepagerow=100"};
				
				//!!! SearchMode가 smServerPaging 인 경우에는 반드시 DoSearchPaging 함수를 통해 조회하여야 한다.
				mySheet.DoSearchPaging("serverpaging_data_oracle.jsp",param);
				break;
			case "reload":
				mySheet.RemoveAll();
				mySheet.FitColWidth();   
				
				break;

			case "save":
				alert(mySheet.GetSaveString());
				break;
				
			case "directdown2excel":
			
//				mySheet.Down2Excel({Merge:1});
						var eparam = makeExParam("serviceID", "8937221121");
							eparam += makeExParam("emp_id", "SA9082211"); 
							
              eparam = eparam.substring(1); //맨 앞에 &기호를 제거함.
              var param = {URL:"../13_search/directdown2excel_data.jsp",FileName:"다이렉트 다운엑셀(대용량).xlsx",SheetName:"sheet-test",Merge:1,SheetDesign:1,ExtendParam:eparam}
              mySheet.DirectDown2Excel(param);
			
			
				break;
		}
	}
	
	
	function makeExParam(key,data){
	return "&"+encodeURIComponent(key)+"="+encodeURIComponent(data);
}


	/* IB Sheet 7 Event */
	function mySheet_OnSearchEnd(code,msg) {
		if(code<0){
			alert("조회 중 오류가 발생하였습니다.\n\n/01_basic/serverpaging_data.jsp 파일 안에 DB 설정을 확인하여 주세요.");	
		}
		mySheet.FitColWidth();
	}
</script>

<body onLoad="LoadPage()">
        <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">데이터조회 &gt; <b>대량조회</b></span>
        </div>
                
        <div class="main_content">
            <div class="exp_product">
                스크롤바 위치에 따라 해당하는 데이터를 순간순간 서버로부터 가져와 화면에 로딩한다.
            </div>
        
            <div class="ib_function float_right">
                <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
                <a href="javascript:doAction('directdown2excel')" class="f1_btn_white gray">엑셀다운</a>
                <a href="javascript:doAction('search')" class="f1_btn_white gray">조회</a>
                
            </div>
            
            <div class="clear hidden"></div>  

			<p class="subtit_sheet">조회리스트</p>
            <div class="ib_product">
				<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
            </div>
			<p class="t_orange">
				이 예제는 데이터베이스와 연동됨으로 사용전에 관련 테이블이 생성되어야 합니다.<br/> 
				/Sample_IBSheet/01/우편번호.sql 파일을 열어 테이블과 내용을 입력하시고, serverpaging_data.jsp 파일에서
				DB접속 정보를 수정하신 후, 사용하시기 바랍니다.
			</p>
        </div>
        <!--main_content-->

</body>
</html>








