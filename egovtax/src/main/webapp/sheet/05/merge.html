<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	

<link rel="stylesheet" href="../../css/style.css"/>
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>
</head>

<script language="javascript">
	var pageheightoffset = 250;

	/*Sheet 기본 설정 */
	function LoadPage() {
//		alert("IBSheet 버젼:"+mySheet.Version());
		var cfg = {SearchMode:2, Page:100, MergeSheet:msHeaderOnly};
		var headers = [
			{Text:"신청인|신청일자|결재여부|신청금액|근태기간|근태기간|시간|시간", Align:"Center"}
			,{Text:"신청인|신청일자|결재여부|신청금액|시작일|종료일|시작|종료", Align:"Center"}
		];
		var info = {Sort:1,ColMove:1,ColResize:1,HeaderCheck:0};
		var cols = [
			{Type:"Text",Width:80,ColMerge:1},
			{Type:"Date",Width:100,Format:"Ymd",ColMerge:1,Align:"Center"},
			{Type:"CheckBox",Width:80,SaveName:"A",ColMerge:0},
			{Type:"AutoSum",Width:85,SaveName:"B",Format:"Integer",ColMerge:0},
			{Type:"Date",Width:100,SaveName:"C",Format:"Ymd",Align:"Center",ColMerge:0},
			{Type:"Date",Width:100,SaveName:"D",Format:"Ymd",Align:"Center",ColMerge:0},
			{Type:"Date",Width:100,Format:"Hm",Align:"Center",ColMerge:1},
			{Type:"Date",Width:100,Format:"Hm",Align:"Center",ColMerge:1}
		];
		
		mySheet.SetConfig(cfg);
		mySheet.InitHeaders(headers,info);
		mySheet.InitColumns(cols);
		
		mySheet.FitColWidth();
	}

	/*Sheet 각종 처리*/
	function doAction(sAction) {
		switch(sAction) {
			case "search":
				mySheet.DoSearch("merge_data.xml");
				break;
			case "reload":
				mySheet.RemoveAll();
				break;
		}
	}
	function mySheet_OnSearchEnd(code,msg){

		mySheet.FitColWidth();	

	}
	function mergeChg(str){
		mySheet.SetMergeSheet(eval(str));
		doAction('search');
	}
</script>

<body onLoad="LoadPage()">
        <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">머지(Merge)기능 > <b>기본기능</b></span>
        </div>
                
        <div class="main_content">
            <div class="exp_product">
                머지영역에 따른 자동머지 기능을 확인한다. 
            </div>
        
            <div class="ib_function float_right">
                <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
                <a href="javascript:doAction('search')" class="f1_btn_white gray">조회</a>
            </div>

			<div class="clear hidden"></div>  
            
            <div class="ib_function2 border_sheet">
				<table class="ib_basic">
					<tr>
						<th class="tit">머지종류 -  </th>
						<td><input type="radio" name="rdo" value="전체머지없음"  onClick="mergeChg('msNone')"  class="radio" />전체머지없음</td>
                        <td><input type="radio" name="rdo" value="헤더만머지"  onClick="mergeChg('msHeaderOnly')"  class="radio" checked/>헤더만머지</td>
                        <td><input type="radio" name="rdo" value="전체머지가능"  onClick="mergeChg('msAll')"  class="radio" />전체머지가능</td>
                        <td><input type="radio" name="rdo" value="앞컬럼기준머지"  onClick="mergeChg('msHeaderOnly + msPrevColumnMerge')"  class="radio" />앞컬럼기준머지</td>
                        
                        <!--<select onChange="mergeChg(this.value)">
								<option value="msNone">전체머지없음</option>
								<option value="msHeaderOnly" selected>헤더만머지</option>
								<option value="msAll">전체머지가능</option>
								<option value="msHeaderOnly + msPrevColumnMerge">앞컬럼기준머지</option>
							</select>-->
					</tr>
				</table> 
			</div>

			<p class="subtit_sheet">조회리스트</p>
            <div class="ib_product">
				<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
            </div>
        </div>
        <!--main_content-->

</body>
</html>








