<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>
</head>
<style>
.benefit_c{color:"#FF0000"}
</style>
<script language="javascript">
	var pageheightoffset = 200;
	/*Sheet 기본 설정 */
	function LoadPage() {
			mySheet.SetTheme("GY","Gray");	
			
			var ibsheet = {};

			ibsheet.Cfg={ SearchMode:smLazyLoad, MergeSheet: msFixedMerge + msHeaderOnly	};

			ibsheet.Header = {Sort:true};
			
			ibsheet.Cols = [ 
				[
			{ Header: "상태", Type: "Status",SaveName:"sStatus", Align: "Center",Width:50,RowSpan:2},	
			 { Header: "선택", Type: "CheckBox",SaveName:"CHK", Edit: 1, Align: "Center",Width:50},
			 { Header: "이미지",RowSpan:2, Type: "Image",SaveName:"productImage",Width:100,  Align: "Center",ImgWidth:80,ImgHeight:80},
			 { Header: "종류", Type: "Text",SaveName:"category", Width:100, Align: "Center",FontColor:"#AAAAAA"},
			 { Header: "특징", Type: "Text",SaveName:"spec", Edit: 1,Width:200, Align: "Left",RowSpan:2,Wrap:1,MultiLineText:1},
			 { Header: "가격", Type: "AutoSum",SaveName:"price", Edit: 1,Width:80, Align: "Right",RowSpan:2},
			 { Header: "혜택", Type: "Html",SaveName:"benefit", Edit: 1,Width:80, Align: "Center"},
			 { Header: "등록일", Type: "Text",SaveName:"cdate",Format:"Ymd",Width:80, Align: "Center"}
			 
			 	]
			 	,[
			 	{ Header: "상태"},
			 	{ Header: "순번", Type: "Seq",SaveName:"SEQ", Align: "Center"},
			 { Header: "이미지"},
			 { Header: "제품명", Type: "Text",SaveName:"productName",  Align: "Center"},
			 { Header: "특징"},
			 { Header: "가격"},
			 { Header: "배송비", Type: "Text",SaveName:"shipping",  Align: "Center"},
			 { Header: "판매자", Type: "Image",SaveName:"seller",  Align: "Center",ImgHeight:22}
			 
			 	
			 	]
			];
			
			IBS_InitSheet(mySheet, ibsheet);
			mySheet.SetEditableColorDiff (0);
			mySheet.SetColFontUnderline("productName",1);
//			mySheet.SetRowHidden(mySheet.LastRow(),1);
			doAction('search');
	}

	/*Sheet 각종 처리*/
	function doAction(sAction) {
		switch(sAction) {
			case "search":      //조회
				mySheet.DoSearch("multilinedata.json");
				break;
			case "reload":
				mySheet.RemoveAll();
				mySheet.FitColWidth();
				break;
			case "insert":
				mySheet.DataInsert()
				break;
			case "delete":
				var a = mySheet.FindCheckedRow("CHK");
				mySheet.RowDelete(a);
				break;
				case "down2excel":
				mySheet.Down2Excel({"FileName":"text.xlsx",Merge:1,SheetDesign:1});
				break;
			case "save":
			
//				var a = mySheet.GetSaveJson();
//				alert(JSON.stringify(a));
				break;
				
		}
	}

	/* IB Sheet 7 Event */
	function mySheet_OnSearchEnd() {
		mySheet.FitColWidth();
	}

</script>

<body onload="LoadPage()">
        <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">기본기능 > <b>Multiline 사용 예제</b></span>
        </div>
                
        <div class="main_content">
            <div class="exp_product">
                DB 테이블상 하나의 레코드를 ibsheet 안에서 두개 이상의 행으로 표현하는 기능.
            </div>
        
            <div class="ib_function float_right">
                <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
                <a href="javascript:doAction('search')" class="f1_btn_white gray">조회</a>
                <a href="javascript:doAction('insert')" class="f1_btn_white gray">신규</a>
                <a href="javascript:doAction('save')" class="f1_btn_white gray">저장</a>
                <a href="javascript:doAction('down2excel')" class="f1_btn_white gray">엑셀다운</a>
                <a href="javascript:doAction('delete')" class="f1_btn_white gray">선택항목삭제</a>
            </div>
            
            <div class="clear hidden"></div>  
        	
			<p class="subtit_sheet">조회리스트</p>
            <div class="ib_product">
							<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
            </div>
        </div>
        <!--main_content-->

</body>
</html>
