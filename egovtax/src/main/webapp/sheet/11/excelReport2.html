<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	

<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>
</head>

<script language="javascript">
	/*Sheet 기본 설정 */
	function LoadPage() {
		var cfg = {SearchMode:2,Page:100};
		var headers = [
			{Text:"모델번호|평형|단가(A)|판매가(B)\nA * 1.03 / 100|현금구입가(C)\n A * 0.9 / 100|할부구입가(D)\nA * 0.93 / 100|현금부담액\nB-C|할부부담액\nB-D", Align:"Center"}
		];
		var info = {Sort:1,ColMove:1,ColResize:1,HeaderCheck:0};
		var cols = [
			{Type:"Text",Width:130},
			{Type:"Text",Width:100},
			{Type:"Int",Width:80,SaveName:"A", Align:"Right"},
			{Type:"AutoSum",Width:85,SaveName:"B",Format:"#,##0.00",CalcLogic:"|A|*1.03/100", Align:"Right"},
			{Type:"AutoSum",Width:85,SaveName:"C",Format:"#,##0.00",CalcLogic:"|A|*0.9/100", Align:"Right"},
			{Type:"AutoSum",Width:85,SaveName:"D",Format:"#,##0.00",CalcLogic:"|A|*0.93/100", Align:"Right"},
			{Type:"AutoAvg",Width:85,Format:"#,##0.00",CalcLogic:"|B|-|C|",ColMerge:1, Align:"Right"},
			{Type:"AutoAvg",Width:85,Format:"#,##0.00",CalcLogic:"|B|-|D|", Align:"Right"}
		];

		mySheet.SetConfig(cfg);
		mySheet.InitHeaders(headers,info);
		mySheet.InitColumns(cols);
		multiSubSum = true;
	    var info = [{StdCol:0, SumCols:"6|7", ShowCumulate:1,Sort:0}
	    ,{StdCol:1, SumCols:"2|3|4|5", ShowCumulate:0,Sort:0,CaptionCol:1}];
	   	mySheet.ShowSubSum(info); 
		mySheet.FitColWidth();
	}

	/*Sheet 각종 처리*/
	function doAction(sAction) {
		switch(sAction) {
			case "search":      //조회
				mySheet.DoSearch("excel_data2.xml");
				break;
			case "reload":        //저장
				mySheet.RemoveAll();
				break;
			case "down2excel":
				var param = "?" + FormQueryStringEnc(document.forms[0]);
				
				if(document.getElementById("merge_1").checked == true){
					param = param + "&merge_L1=True";
				}else{
					param = param + "&merge_L1=False";
				}
				
				if(document.getElementById("merge_2").checked == true){
					param = param + "&merge_L2=True";
				}else{
					param = param + "&merge_L2=False";
				}
							
				var info = {Merge:1, OnlyHeaderMerge:1, SheetDesign:1, ReportXMLURL:"../11/excelReportDown.jsp"+param};
				//var info = {Merge:1, OnlyHeaderMerge:1, SheetDesign:1, ReportXMLURL:"../11/test.xml"};
				mySheet.Down2Excel(info);
				break;
			case "loadexcel":
				mySheet.RemoveAll();
				var mch = document.getElementById("match").value;
			var params = { Mode : mch,  StartRow: "6"} ;
			
			mySheet.LoadExcel(params);
				break;
		}
	}

	function mySheet_OnSearchEnd(){
		mySheet.FitColWidth();
	}
</script>

<body onLoad="LoadPage()">
        <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">기타기능 > <b>엑셀리포트패턴</b></span>
        </div>
                
        <div class="main_content">
            <div class="exp_product">
                시트의 내용을 엑셀로 다운로드 받을때, 데이터 패턴이나 Label 설정 기능을 확인한다.
            </div>
        
            <div class="ib_function float_right">
                <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
                <a href="javascript:doAction('search')" class="f1_btn_white gray">조회</a>
                <a href="javascript:doAction('down2excel')" class="f1_btn_white gray">다운로드</a>
            </div>

			<div class="clear hidden"></div>  
            <form id="form" name="form">
            <p class="subtit_sheet">데이터패턴</p>
            <div class="ib_function2 border_sheet">
				<table class="ib_column2">
					<tr>						
						<th class="tit">기준컬럼</th>
						<td class="r20">
							<select id="standardCol" class="selectbox">
								<option value="1" selected>모델번호</option>
								<option value="2" >평형</option>
								<option value="3" >단가</option>
							</select>
						</td>
						<th class="tit">기준문자열</th>
						<td class="r20"><input type="text" id="standardtext" value="소계*" size="15" class="inputbox"/></td>
						<th class="tit">적용범위</th>
                        <td class="r20" colspan="5">Col1 <input type="text" id="col1" value="1" size="3" class="inputbox"/> ~ Col2 <input type="text" id="col2" value="8" size="3" class="inputbox"/></td>
					</tr>
					<tr>
						<th class="tit">폰트명</th>
						<td class="r20"><input type="text" id="fontname" value="" size="15" class="inputbox"/></td>
						<th class="tit">폰트색상(R,G,B)</th>
						<td class="r20"><input type="text" id="fontcolor1" size="3" name="fontcolor1" value="0" class="inputbox">,<input type="text" id="fontcolor2" size="3" name="fontcolor2" value="0" class="inputbox">,<input type="text" id="fontcolor3" size="3" name="fontcolor3" value="0" class="inputbox"></td>
						<th class="tit">셀배경색</th>
                        <td class="r20"><input type="text" id="backcolor1" size="3" name="backcolor1" value="204" class="inputbox">,<input type="text" id="backcolor2" size="3" name="backcolor2" value="255" class="inputbox">,<input type="text" id="backcolor3" size="3" name="backcolor3" value="204" class="inputbox"></td>
						<th class="tit">셀패턴</th>
						<td class="r20">
							<select id="cellpattern" class="selectbox">
								<option value="xlGray50" >xlGray50</option>
								<option value="xlHorizontal" selected>xlHorizontal</option>
								<option value="xlVertical" >xlVertical</option>
								<option value="xlDown" >xlDown</option>
								<option value="xlSemiGray75" >xlSemiGray75</option>
								<option value="xlLightUp" >xlLightUp</option>
								<option value="xlCrissCross" >xlCrissCross</option>
							</select>
						</td>
						<th class="tit">패턴색상</th>
                        <td class="r20"><input type="text" id="patterncolor1" size="3" name="patterncolor1" value="255" class="inputbox">,<input type="text" id="patterncolor2" size="3" name="patterncolor2" value="204" class="inputbox">,<input type="text" id="patterncolor3" size="3" name="patterncolor3" value="255" class="inputbox"></td>
					</tr>
					<tr>						
						<th class="tit">위쪽 스타일</th>
						<td class="r20" colspan="4">
							<select id="upstyle" class="selectbox">
								<option value="None" >선없음</option>
								<option value="Continuous" selected>연속선</option>
								<option value="Dash" >대쉬</option>
								<option value="DashDot" >대쉬+점</option>
								<option value="DashDotDot" >대쉬+점+점</option>
								<option value="Dot" >점선</option>
								<option value="Double" >이중선</option>
								<option value="SlantDashDot" >기울어진대쉬+점</option>
							</select>
							&nbsp;&nbsp;선굵기
							<select id="uplinestyle" class="selectbox">
								<option value="Hairline" >매우가는선</option>
								<option value="Thin" selected>가는선</option>
								<option value="Medium" >중간굵은선</option>
								<option value="Thick" >굵은선</option>
							</select>
							&nbsp;&nbsp;선색상
							<input type="text" id="uplinecolor1" size="3" name="uplinecolor1" value="255" class="inputbox">,<input type="text" id="uplinecolor2" size="3" name="uplinecolor2" value="255" class="inputbox">,<input type="text" id="uplinecolor3" size="3" name="uplinecolor3" value="255" class="inputbox">
						</td>
						<th class="tit">아래쪽 스타일</th>
						<td class="r20" colspan="4">
							<select id="downwstyle" class="selectbox">
								<option value="None" >선없음</option>
								<option value="Continuous" selected>연속선</option>
								<option value="Dash" >대쉬</option>
								<option value="DashDot" >대쉬+점</option>
								<option value="DashDotDot" >대쉬+점+점</option>
								<option value="Dot" >점선</option>
								<option value="Double" >이중선</option>
								<option value="SlantDashDot" >기울어진대쉬+점</option>
							</select>
							&nbsp;&nbsp;선굵기
							<select id="downwlinestyle" class="selectbox">
								<option value="Hairline" >매우가는선</option>
								<option value="Thin" selected>가는선</option>
								<option value="Medium" >중간굵은선</option>
								<option value="Thick" >굵은선</option>
							</select>
							&nbsp;&nbsp;선색상
							<input type="text" id="downwlinecolor1" size="3" name="downwlinecolor1" value="255" class="inputbox">,<input type="text" id="downwlinecolor2" size="3" name="downwlinecolor2" value="255" class="inputbox">,<input type="text" id="downwlinecolor3" size="3" name="downwlinecolor3" value="255" class="inputbox">
						</td>
					</tr>
					<tr>						
						<th class="tit">왼쪽 스타일</th>
						<td class="r20" colspan="4">
							<select id="leftstyle" class="selectbox">
								<option value="None" >선없음</option>
								<option value="Continuous" selected>연속선</option>
								<option value="Dash" >대쉬</option>
								<option value="DashDot" >대쉬+점</option>
								<option value="DashDotDot" >대쉬+점+점</option>
								<option value="Dot" >점선</option>
								<option value="Double" >이중선</option>
								<option value="SlantDashDot" >기울어진대쉬+점</option>
							</select>
							&nbsp;&nbsp;선굵기
							<select id="leftlinestyle" class="selectbox">
								<option value="Hairline" >매우가는선</option>
								<option value="Thin" selected>가는선</option>
								<option value="Medium" >중간굵은선</option>
								<option value="Thick" >굵은선</option>
							</select>
							&nbsp;&nbsp;선색상
							<input type="text" id="leftlinecolor1" size="3" name="leftlinecolor1" value="255" class="inputbox">,<input type="text" id="leftlinecolor2" size="3" name="leftlinecolor2" value="255" class="inputbox">,<input type="text" id="leftlinecolor3" size="3" name="leftlinecolor3" value="255" class="inputbox">
						</td>
						<th class="tit">오른쪽 스타일</th>
						<td class="r20" colspan="4">
							<select id="rightwstyle" class="selectbox">
								<option value="None" >선없음</option>
								<option value="Continuous" selected>연속선</option>
								<option value="Dash" >대쉬</option>
								<option value="DashDot" >대쉬+점</option>
								<option value="DashDotDot" >대쉬+점+점</option>
								<option value="Dot" >점선</option>
								<option value="Double" >이중선</option>
								<option value="SlantDashDot" >기울어진대쉬+점</option>
							</select>
							&nbsp;&nbsp;선굵기
							<select id="rightwlinestyle" class="selectbox">
								<option value="Hairline" >매우가는선</option>
								<option value="Thin" selected>가는선</option>
								<option value="Medium" >중간굵은선</option>
								<option value="Thick" >굵은선</option>
							</select>
							&nbsp;&nbsp;선색상
							<input type="text" id="rightwlinecolor1" size="3" name="rightwlinecolor1" value="255" class="inputbox">,<input type="text" id="rightwlinecolor2" size="3" name="rightwlinecolor2" value="255" class="inputbox">,<input type="text" id="rightwlinecolor3" size="3" name="rightwlinecolor3" value="255" class="inputbox">
						</td>
					</tr>
				</table>
           </div>

			<p class="subtit_sheet">두번째 라벨</p>
            <div class="ib_function2 border_sheet">
				<table class="ib_column2">
					<tr>						
						<th class="tit">라벨텍스트</th>
						<td class="r20">
							<input type="text" id="labeltxt_1" value="전자제품 단가표" size="15" class="inputbox"/>
						</td>
						<th class="tit">영역위치</th>
                        <td class="r20" colspan="3">
                        (<input type="text" id="row1_1" value="1" size="3" class="inputbox"/>,<input type="text" id="col1_1" value="1" size="3" class="inputbox"/>)
                         ~  (<input type="text" id="row2_1" value="2" size="3" class="inputbox"/>,<input type="text" id="col2_1" value="8" size="3" class="inputbox"/>)</td>
                        <th class="tit">행높이</th>
						<td class="r20">
							<input type="text" id="rowheight_1" value="20" size="15" class="inputbox"/>
						</td>
						<th class="tit">머지여부</th>
						<td class="r20">
							<input type="checkbox" id="merge_1" value="20" size="15" checked/>
						</td>
					</tr>
					<tr>
						<th class="tit">가로정렬</th>
						<td class="r20">
							<select id="horizontal_1" class="selectbox">
								<option value="Left" >왼쪽</option>
								<option value="Center" selected>가운데</option>
								<option value="Right" >오른쪽</option>
							</select>
						</td>
						<th class="tit">수직정렬</th>
						<td class="r20">
							<select id="vertical_1" class="selectbox">
								<option value="Top" >왼쪽</option>
								<option value="Center" selected>가운데</option>
								<option value="Bottom" >오른쪽</option>
							</select>
						</td>
						<th class="tit">셀배경색</th>
                        <td class="r20"><input type="text" id="backcolor_L1_1" size="3" name="backcolor_L1_1" value="255" class="inputbox">,<input type="text" id="backcolor_L2_1" size="3" name="backcolor_L2_1" value="228" class="inputbox">,<input type="text" id="backcolor_L3_1" size="3" name="backcolor_L3_1" value="196" class="inputbox"></td>
						<th class="tit">셀패턴</th>
						<td class="r20">
							<select id="labelpattern_1" class="selectbox">
								<option value="xlGray50"  >xlGray50</option>
								<option value="xlHorizontal"  >xlHorizontal</option>
								<option value="xlVertical" >xlVertical</option>
								<option value="xlDown" >xlDown</option>
								<option value="xlSemiGray75" >xlSemiGray75</option>
								<option value="xlLightUp" selected>xlLightUp</option>
								<option value="xlCrissCross" >xlCrissCross</option>
							</select>
						</td>
						<th class="tit">패턴색상</th>
                        <td class="r20"><input type="text" id="patterncolor_L1_1" size="3" name="patterncolor_L1_1" value="255" class="inputbox">,<input type="text" id="patterncolor_L2_1" size="3" name="patterncolor_L2_1" value="192" class="inputbox">,<input type="text" id="patterncolor_L3_1" size="3" name="patterncolor_L3_1" value="203" class="inputbox"></td>
					</tr>
					<tr>
						<th class="tit">폰트명</th>
						<td class="r20"><input type="text" id="fontname_L1" value="" size="15" class="inputbox"/></td>
						<th class="tit">폰트색상(R,G,B)</th>
						<td class="r20"><input type="text" id="fontcolor1_L1" size="3" name="fontcolor1_L1" value="0" class="inputbox">,<input type="text" id="fontcolor2_L1" size="3" name="fontcolor2_L1" value="0" class="inputbox">,<input type="text" id="fontcolor3_L1" size="3" name="fontcolor3_L1" value="0" class="inputbox"></td>
						<th class="tit">폰트크기</th>
						<td class="r20" colspan="5">
							<select id="fontsize_L1" class="selectbox">
								<option value="8" >8pt</option>
								<option value="10" >10pt</option>
								<option value="12" >12pt</option>
								<option value="14" selected>14pt</option>
								<option value="16" >16pt</option>
								<option value="18" >18pt</option>
								<option value="24" >24pt</option>
							</select>
						</td>
					</tr>
				</table>
           </div>
           
           <p class="subtit_sheet">라벨속성</p>
            <div class="ib_function2 border_sheet">
				<table class="ib_column2">
					<tr>						
						<th class="tit">라벨텍스트</th>
						<td class="r20">
							<input type="text" id="labeltxt_2" value="아이비리더스" size="15" class="inputbox"/>
						</td>
						<th class="tit">영역위치</th>
                        <td class="r20" colspan="3">
                        (<input type="text" id="row1_2" value="4" size="3" class="inputbox"/>,<input type="text" id="col1_2" value="1" size="3" class="inputbox"/>)
                         ~  (<input type="text" id="row2_2" value="4" size="3" class="inputbox"/>,<input type="text" id="col2_2" value="2" size="3" class="inputbox"/>)</td>
                        <th class="tit">행높이</th>
						<td class="r20">
							<input type="text" id="rowheight_2" value="20" size="15" class="inputbox"/>
						</td>
						<th class="tit">머지여부</th>
						<td class="r20">
							<input type="checkbox" id="merge_2" value="20" size="15" checked/>
						</td>
					</tr>
					<tr>
						<th class="tit">가로정렬</th>
						<td class="r20">
							<select id="horizontal_2" class="selectbox">
								<option value="Left" >왼쪽</option>
								<option value="Center" selected>가운데</option>
								<option value="Right" >오른쪽</option>
							</select>
						</td>
						<th class="tit">수직정렬</th>
						<td class="r20">
							<select id="vertical_2" class="selectbox">
								<option value="Top" >왼쪽</option>
								<option value="Center" selected>가운데</option>
								<option value="Bottom" >오른쪽</option>
							</select>
						</td>
						<th class="tit">셀배경색</th>
                        <td class="r20"><input type="text" id="backcolor_L1_2" size="3" name="backcolor_L1_2" value="255" class="inputbox">,<input type="text" id="backcolor_L2_2" size="3" name="backcolor_L2_2" value="255" class="inputbox">,<input type="text" id="backcolor_L3_2" size="3" name="backcolor_L3_2" value="255" class="inputbox"></td>
						<th class="tit">셀패턴</th>
						<td class="r20">
							<select id="labelpattern_2" class="selectbox">
								<option value="" selected>없음</option>
								<option value="xlGray50" >xlGray50</option>
								<option value="xlHorizontal" >xlHorizontal</option>
								<option value="xlVertical" >xlVertical</option>
								<option value="xlDown" >xlDown</option>
								<option value="xlSemiGray75" >xlSemiGray75</option>
								<option value="xlLightUp" >xlLightUp</option>
								<option value="xlCrissCross" >xlCrissCross</option>
							</select>
						</td>
						<th class="tit">패턴색상</th>
                        <td class="r20"><input type="text" id="patterncolor_L1_2" size="3" name="patterncolor_L1_2" value="255" class="inputbox">,<input type="text" id="patterncolor_L2_2" size="3" name="patterncolor_L2_2" value="255" class="inputbox">,<input type="text" id="patterncolor_L3_2" size="3" name="patterncolor_L3_2" value="255" class="inputbox"></td>
					</tr>
					<tr>
						<th class="tit">폰트명</th>
						<td class="r20"><input type="text" id="fontname_L2" value="" size="15" class="inputbox"/></td>
						<th class="tit">폰트색상(R,G,B)</th>
						<td class="r20"><input type="text" id="fontcolor1_L2" size="3" name="fontcolor1_L2" value="0" class="inputbox">,<input type="text" id="fontcolor2_L2" size="3" name="fontcolor2_L2" value="0" class="inputbox">,<input type="text" id="fontcolor3_L2" size="3" name="fontcolor3_L2" value="0" class="inputbox"></td>
						<th class="tit">폰트크기</th>
						<td class="r20" colspan="5">
							<select id="fontsize_L2" class="selectbox">
								<option value="8" >8pt</option>
								<option value="10" >10pt</option>
								<option value="12" >12pt</option>
								<option value="14" selected>14pt</option>
								<option value="16" >16pt</option>
								<option value="18" >18pt</option>
								<option value="24" >24pt</option>
							</select>
						</td>
					</tr>
				</table>
           </div>
           </form>
			<p class="subtit_sheet">조회리스트</p>
            <div class="ib_product" style="height:400px">
				<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
            </div>
        </div>
        <!--main_content-->

</body>
</html>








