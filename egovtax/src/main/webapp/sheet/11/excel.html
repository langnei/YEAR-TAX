<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	

<link rel="stylesheet" href="../../css/style.css"/>
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>
</head>

<script language="javascript">
	var pageheightoffset = 270;
	/*Sheet 기본 설정 */
	function LoadPage() {
		var cfg = {SearchMode:2, Page:100, MergeSheet:msHeaderOnly};
		var headers = [
			{Text:"신청인|신청일자|결재여부|신청금액|근태기간|근태기간|시간|시간", Align:"Center"}
			,{Text:"신청인|신청일자|결재여부|신청금액|시작일|종료일|시작|종료", Align:"Center"}
		];
		var info = {Sort:1,ColMove:1,ColResize:1,HeaderCheck:0,ColPage:5};
		var cols = [
			{Type:"Text",Width:80,ColMerge:1},
			{Type:"Combo",Width:80,ColMerge:0,Align:"Center",ComboText:"야근|주말특근|휴일특근",ComboCode:"001|002|004"},
			{Type:"CheckBox",Width:80,SaveName:"A",ColMerge:1},
			{Type:"Int",Width:85,SaveName:"B",ColMerge:1},
			{Type:"Date",Width:100,SaveName:"C",Format:"Ymd",Align:"Center"},
			{Type:"Date",Width:100,SaveName:"D",Format:"Ymd",Align:"Center"},
			{Type:"Date",Width:100,Format:"Hm",Align:"Center"},
			{Type:"Date",Width:100,Format:"Hm",Align:"Center"}
		];

		mySheet.SetConfig(cfg);
		mySheet.InitHeaders(headers,info);
		mySheet.InitColumns(cols);
		try{console.log(mySheet.Version())}catch(e){}

		mySheet.FitColWidth();
	}

	/*Sheet 각종 처리*/
	function doAction(sAction) {
		switch(sAction) {
			case "search":      //조회
				mySheet.DoSearch("excel_data.xml");
				break;
			case "reload":        //저장
				mySheet.RemoveAll();
				break;
			case "down2excel":
			

			
			
			var filename = document.getElementById("filename").value;
			var worksheetname = document.getElementById("worksheetname").value;
			var merge = document.getElementById("merge").checked?1:0;
			var design = document.getElementById("design").checked?1:0;
			var t = new Date();
			var DandT = t.getFullYear() + "-" +AddZero(t.getMonth()+1)+"-" + AddZero(t.getDate())+"   "+AddZero(t.getHours())+":"+AddZero(t.getMinutes());
			
			var TITLE = "[잔업 수당 신청]\r\n\r\n|문서번호:  (0009)";
					TITLE += "\r\n | 신청기간: 2003-09 ~ 2004-09";
					TITLE += "\r\n[ "+mySheet.RowCount()+" ]건, 출력시간 : "+DandT+"||||||단위: 원";
					var userMG  = "0,0,2,8 2,1,1,5 3,1,1,5 4,0,1,5 4,6,1,2";

			var params = { FileName :filename,  SheetName :worksheetname,Merge:merge,SheetDesign:design,TitleText:TITLE,UserMerge:userMG,DownSum:0,ComboValidation:1} ;
			//var params = {TempFile :"/ibsheet7_sample/sheet/11/template.xlsx",SheetName:"Sheet2"} ;
			mySheet.Down2Excel(params);

				break;
			case "loadexcel":
				mySheet.RemoveAll();
				var mch = document.getElementById("match").value;
				var params = { Mode : mch,  StartRow: "6"} ;
			
				mySheet.LoadExcel(params);
				break;
		}
	}

function AddZero(str){
	
	if((str+"").length==1){
		return "0"+str;
	}	
	return str;
}
	function mySheet_OnSearchEnd() {
		mySheet.FitColWidth();
	}

	function mySheet_OnResize() {
		mySheet.FitColWidth();
	}
	
	


//function mySheet_OnReadyExcelDown(frm){

//var v = frm.Data.value;
//
//var mid = "Text|Text|Text|Int|Text|Text|Text|Text";
//var front = v.substring(0, (v.indexOf("<RecordTypes>")+13)); 
//var end = v.substring(v.indexOf("</RecordTypes>"));
//v = front + mid + end;
//
//
//
//mid = "|||#,###||||";
//front = v.substring(0, (v.indexOf("<RecordFormats>")+15)); 
//end = v.substring(v.indexOf("</RecordFormats>"));
//v = front + mid + end;
//
//
//
//mid = "|||NullInteger||||";
//front = v.substring(0, (v.indexOf("<RecordOrgFormats>")+18)); 
//end = v.substring(v.indexOf("</RecordOrgFormats>"));
//
//v  = front + mid + end;
//
//frm.Data.value = v;
//frm.submit();
//	
//}
</script>

<body onLoad="LoadPage()">
        <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">기타기능 > <b>엑셀연동</b></span>
        </div>
                
        <div class="main_content">
            <div class="exp_product">
                시트의 내용을 엑셀로 다운받거나, 클라이언트 피씨의 엑셀파일의 내용을 시트위로 로딩하는 기능을 확인한다. 
            </div>
        
            <div class="ib_function float_right">
                <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
                <a href="javascript:doAction('search')" class="f1_btn_white gray">조회</a>
            </div>

			<div class="clear hidden"></div>  
            
            <div class="ib_function2 border_sheet">
				<table class="ib_column2">
					<tr>
						
						<th class="tit">파일명</th>
						<td class="r20"><input type="text" id="filename" value="myFile.xls" size="10" class="inputbox"/></td>
						<th class="tit">Worksheet</th>
						<td class="r20"><input type="text" id="worksheetname" value="MYWORKSHEET" size="15" class="inputbox"/></td>
						<td>머지반영</td>
						<td class="r20"><input class="checkbox" type="checkbox" checked="checked" id="merge" /></td>
						<td>디자인반영</td>
						<td class="r20"><input class="checkbox" type="checkbox" checked="checked" id="design"/></td>
                        <td class="r20"><a href="javascript:doAction('down2excel');" class="f2_btn_white btn_sheet" style="width:80px">엑셀다운</a></td>
					 </tr>
					<tr>
						
						<th class="tit">매칭방식</th>
						<td class="r20" colspan="7">
							<select id="match" class="selectbox">
								<option value="HeaderMatch" selected>해더 타이틀 비교</option>
								<option value="NoHeader">좌측부터 순서대로</option>
								<option value="HeaderSkip">첫번째행 무시</option>
							</select>
						</td>
                        <td class="r20"><a href="javascript:doAction('loadexcel');" class="f2_btn_white btn_sheet"  style="width:80px">엑셀업로드</a></td>
					 </tr>
				</table>
           </div>

			<p class="subtit_sheet">조회리스트</p>
            <div class="ib_product">
				<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
            </div>
        </div>
        <!--main_content-->

</body>
</html>








