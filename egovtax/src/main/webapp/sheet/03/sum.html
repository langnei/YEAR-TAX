<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	

<link rel="stylesheet" href="../../css/style.css"/>
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>
</head>

<script language="javascript">
	var pageheightoffset = 250;

	/*Sheet 기본 설정 */
	function LoadPage() {
		var cfg = {SearchMode:2,Page:100};
		var headers = [
			{Text:"모델번호|평형|단가(A)|판매가(B)\nA * 1.03 / 100|현금구입가(C)\n A * 0.9 / 100|할부구입가(D)\nA * 0.93 / 100|현금부담액\nB-C|할부부담액\nB-D", Align:"Center"}
		];
		var info = {Sort:1,ColMove:1,ColResize:1,HeaderCheck:0};
		var cols = [
			{Type:"Text",Width:130},
			{Type:"Text",Width:100},
			{Type:"Int",Width:80,SaveName:"A", Align:"Right"},
			{Type:"AutoSum",Width:85,SaveName:"B",Format:"#,##0.00",CalcLogic:"|A|*1.03/100", Align:"Right"},
			{Type:"AutoSum",Width:85,SaveName:"C",Format:"#,##0.00",CalcLogic:"|A|*0.9/100", Align:"Right"},
			{Type:"AutoSum",Width:85,SaveName:"D",Format:"#,##0.00",CalcLogic:"|A|*0.93/100", Align:"Right"},
			{Type:"AutoAvg",Width:85,Format:"#,##0.00",CalcLogic:"|B|-|C|",ColMerge:1, Align:"Right"},
			{Type:"AutoAvg",Width:85,Format:"#,##0.00",CalcLogic:"|B|-|D|", Align:"Right"}
		];

		mySheet.SetConfig(cfg);
		mySheet.InitHeaders(headers,info);
		mySheet.InitColumns(cols);
		mySheet.SetCountPosition(2);
		mySheet.FitColWidth();

		doAction("search");
	}
var multiSubSum = false;
	/*Sheet 각종 처리*/
	function doAction(sAction) {
		switch(sAction) {
			case "search":
				mySheet.DoSearch("SP03_2_data.xml");
				break;
			case "reload":
				mySheet.RemoveAll();
				break;
		case "removeall":        //저장
      mySheet.RemoveAll();
      break;
    case "subsum":
    	multiSubSum = false;
	    var showcum = document.all.chk.checked?1:0;
	    var info = [{StdCol:0, SumCols:"3|4|5", AvgCols :"2",ShowCumulate:showcum,Sort:0,CaptionCol:0}];
	   	mySheet.ShowSubSum(info); 
	   	doAction('search');
    break;
    case "subsum2":
    	multiSubSum = true;
	    var showcum = document.all.chk.checked?1:0;
	    var info = [{StdCol:0, SumCols:"6|7", ShowCumulate:showcum,Sort:0}
	    ,{StdCol:1, SumCols:"2|3|4|5", ShowCumulate:showcum,Sort:0,CaptionCol:1}];
	   	mySheet.ShowSubSum(info); 
	   	doAction('search');
    break;
    
  	case "hidesubsum":
  		mySheet.RemoveAll();
	    mySheet.HideSubSum();
    break;
		}
	}

function mySheet_OnSearchEnd(cd,msg){
	try{
	//합계 행 다듬기
	mySheet.SetSumValue(0,"합 계/평 균");
	mySheet.SetCellAlign(mySheet.LastRow(),0,"Center");
	mySheet.SetMergeCell (mySheet.LastRow(), 0, 1,2);
	
	var lr = mySheet.LastRow();
	//다중소계 사용시 머지 시키기
	if(multiSubSum){
		var str = "";
		var startrow = 1;
		for(var i=1;i<lr;i++){
			str = mySheet.GetCellText(i,0);			
			if(str.indexOf("소계:")>-1){
					mySheet.SetMergeCell(startrow,0,i-startrow,1);
					if(document.all.chk.checked){
						startrow=i+2;
					}else{
						startrow=i+1;
					}
			}
		}
	}
	
	mySheet.FitColWidth();
	
	
}catch(e){alert(e);}
		
}
	function mySheet_OnResize() {
		mySheet.FitColWidth();
	}
</script>

<body onload="LoadPage()">
        <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">숫자연산기능 > <b>합계/소계</b></span>
        </div>
                
        <div class="main_content">
            <div class="exp_product">
                숫자연산과 관련된 전체합계,컬럼합계,소계 기능을 확인한다. 
            </div>
        
            <div class="ib_function float_right">
                <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
                <a href="javascript:doAction('search')" class="f1_btn_white gray">조회</a>
            </div>

			<div class="clear hidden"></div>  
            
            <div class="ib_function2 border_sheet">
				<table class="ib_column2">
					<tr>
						<td><input class="checkbox" type="checkbox" id="chk"/></td>
						<td class="r20">누계포함</td>
						<td><a href="javascript:doAction('subsum')" class="f2_btn_white btn_sheet">소계</a>
                <a href="javascript:doAction('subsum2');" class="f2_btn_white btn_sheet"><span>다중컬럼소계</span></a>
                <a href="javascript:doAction('hidesubsum');" class="f2_btn_white btn_sheet"><span>소계지우기</span></a>
							
							</td>
					 </tr>
				</table>
			</div>

			<p class="subtit_sheet">조회리스트</p>
            <div class="ib_product">
				<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
            </div>
        </div>
        <!--main_content-->

</body>
</html>








