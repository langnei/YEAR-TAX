<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	
<link rel="stylesheet" href="../../css/style.css"/>
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>
</head>

<script language="javascript">
//	var AutoResizeOff = true;
	var pageheightoffset = 250;

	/*Sheet 기본 설정 */
	function LoadPage() {
		var initData = {};
		initData.Cfg = {SearchMode:2, Page:50,MergeSheet:msHeaderOnly};
		initData.Cols = [
			{Header:"행/열 필드|부서명",Type:"Text", SaveName:"sDept", Width:80, Align:"Center",Edit:0},
			{Header:"행/열 필드|팀명",Type:"Text", SaveName:"sTeam", Width:80, Align:"Center",Edit:0},
			{Header:"행/열 필드|직급",Type:"Text", SaveName:"sPos", Width:80, Align:"Center",Edit:0},
			{Header:"행/열 필드|성명",Type:"Text", SaveName:"sName", Width:80, Align:"Center"},
			{Header:"행/열 필드|성별",Type:"Combo", SaveName:"sSex", Width:80, Align:"Center",ComboText:"男|女",ComboCode:"남|여"},
			{Header:"행/열 필드|연령대",Type:"Text", SaveName:"sAge2", Width:80, Align:"Center"},
			{Header:"행/열 필드|거주지1",Type:"Text", SaveName:"sAddr1", Width:80, Align:"Center"},
			{Header:"값 필드|나이",Type:"Int", SaveName:"sAge", Width:80, Align:"Right"},
			{Header:"값 필드|근속기간",Type:"Int", SaveName:"sYearOfService", Width:80, Align:"Right"},
			{Header:"값 필드|급여",Type:"Int", SaveName:"sSalary", Width:80, Align:"Right",Format:"#,### 원"},
			{Header:"값 필드|상여",Type:"Int", SaveName:"sBonus", Width:80, Align:"Right",Format:"#,### 원"}
		];
		IBS_InitSheet(mySheet,initData);
		
		mySheet.SetDataAutoTrim(0);

		mySheet.FitColWidth();
		
		mySheet.SetCellBackColor(0,0,"#3F73A5");
		mySheet.SetCellFontColor(0,0,"#FFFFFF");

		mySheet.SetCellBackColor(0,7,"#1F5385");
		mySheet.SetCellFontColor(0,7,"#FFFFFF");
		
		doAction("search");
	}
	

	/*Sheet 각종 처리*/
	function doAction(sAction) {
		switch(sAction) {
			case "search":
				mySheet.DoSearch("pivot_data.xml");
				break;
			case "excelDown":
				mySheet.Down2Excel({"FileName":"pivotSheet.xlsx","SheetDesign":2});
			break;
			
		case "removeall":        //저장
      mySheet.RemoveAll();
      break;
      
    case "pivotPop":
    	mySheet.ShowPivotDialog();
    break;
		}
	}


	function mySheet_OnResize() {
		mySheet.FitColWidth();
	}
	function mySheet_OnSearchEnd(cd,msg) {
		mySheet.FitColWidth();
	}
</script>

<body onload="LoadPage()">
		<div class="page_title">
		    <span><a class="closeDepth" href="#">closeDepth</a></span>
		    <span class="title">숫자연산기능 > <b>피벗 / 크로스테이블</b></span>
		</div>
		        
		<div class="main_content">
	    <div class="exp_product">
	        피벗이나 크로스테이블 함수를 이용하여 데이터 변환 과정을 확인한다. 
	    </div>
	
	    <div class="ib_function float_right">
	        <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
	        <a href="javascript:doAction('search')" class="f1_btn_white gray">조회</a>
	        <a href="javascript:doAction('excelDown')" class="f1_btn_white gray">엑셀다운</a>
	    </div>
		
			<div class="clear hidden"></div>  
            
	     <div class="ib_function2 border_sheet">
					<table class="ib_column2">
						<tr>
							<td>
								
								<a href="javascript:doAction('pivotPop')" class="f2_btn_white btn_sheet">피벗/크로스테이블</a>
							</td>
						 </tr>
					</table>
				</div>
			
		
		
		
				<div id="sheetlist">
					<p class="subtit_sheet">조회리스트</p>
          <div class="ib_product">
						<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
          </div>
        </div>
          
	    </div>
     <!--main_content-->



   
</body>
</html>








