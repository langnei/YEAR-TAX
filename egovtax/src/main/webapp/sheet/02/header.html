<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	

<link rel="stylesheet" href="../../css/style.css"/>
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>
</head>

<script language="javascript">
	var pageheightoffset = 250;
	/*Sheet 기본 설정 */
	function LoadPage() {
	var cfg = {SearchMode:1,Page:100};
		var headers = [ {Text:"종목코드|종목명|구분|체결일|체결\n조건|수량|가격|협상대상|협상여부|최대\n참여|현재참여|협상\n참여", Align:"Center"} ];
		var info = {Sort:1,ColMove:1,ColResize:1,HeaderCheck:1};
		var cols = [
		
		        	{Type:"Text",Width:65 ,	SaveName:"param1",Align:"Center"   },
		        	{Type:"Text",Width:65,	SaveName:"param2",Align:"Center"  },
		        	{Type:"Combo",Width:55,SaveName:"param3"		,ComboText:"매도|매수",ComboCode:"00|01"},
		        	{Type:"Combo",Width:55,SaveName:"param4"	  ,ComboText:"당일|익일|특정일|특정일까지",ComboCode:"00|01|02|03"},
		        	{Type:"Text",Width:55,	SaveName:"param5"		},
		        	{Type:"AutoSum",Width:80,	SaveName:"param6"		,Format:"Integer"},
		        	{Type:"Text",Width:55,	SaveName:"param7"		},
		        	{Type:"Combo",Width:70,SaveName:"param8"		,ComboText:"수량|가격|가격,수량",ComboCode:"00|01|02"},
		        	{Type:"Combo",Width:70,SaveName:"param9"		,ComboText:"미협상|협상중|협상완료",ComboCode:"00|01|02"},
		        	{Type:"Text",Width:40,	SaveName:"param10"		},
		        	{Type:"CheckBox",Width:80,	SaveName:"param11",Align:"Center"		},
		        	{Type:"Text",Width:40,	SaveName:"param12",Align:"Center"},
		        	
		];

		mySheet.SetConfig(cfg);
		mySheet.InitHeaders(headers,info);
		mySheet.InitColumns(cols);
		


		doAction('search');

	}

	/*Sheet 각종 처리*/
	function doAction(sAction) {
	  switch(sAction) {
		case "search":      //조회
			mySheet.DoSearch("header_data.xml");
			break;
		case "reload":
			mySheet.RemoveAll();
			break;
		}
	}
	function mySheet_OnSearchEnd(code,msg){

		mySheet.FitColWidth();	

	}

	function headFunc(str,val){
		var sort = document.all.sort.checked?1:0;
		var size = document.all.size.checked?1:0;
		var move = document.all.move.checked?1:0;
		var check = document.all.check.checked?1:0;
		
		var headers = [ {Text:"종목코드|종목명|구분|체결일|체결\n조건|수량|가격|협상대상|협상여부|최대\n참여|현재참여|협상\n참여", Align:"Center"} ];
		var info = {Sort:sort,ColMove:move,ColResize:size,HeaderCheck:check};
		var cols = [
			{Type:"Text",Width:65 ,	SaveName:"param1",Align:"Center"   },
			{Type:"Text",Width:65,	SaveName:"param2",Align:"Center"  },
			{Type:"Combo",Width:55,SaveName:"param3"		,ComboText:"매도|매수",ComboCode:"00|01"},
			{Type:"Combo",Width:55,SaveName:"param4"	  ,ComboText:"당일|익일|특정일|특정일까지",ComboCode:"00|01|02|03"},
			{Type:"Text",Width:55,	SaveName:"param5"		},
			{Type:"AutoSum",Width:80,	SaveName:"param6"		,Format:"Integer"},
			{Type:"Text",Width:55,	SaveName:"param7"		},
			{Type:"Combo",Width:70,SaveName:"param8"		,ComboText:"수량|가격|가격,수량",ComboCode:"00|01|02"},
			{Type:"Combo",Width:70,SaveName:"param9"		,ComboText:"미협상|협상중|협상완료",ComboCode:"00|01|02"},
			{Type:"Text",Width:40,	SaveName:"param10"		},
			{Type:"CheckBox",Width:80,	SaveName:"param11",Align:"Center"		},
			{Type:"Text",Width:40,	SaveName:"param12",Align:"Center"},
		];

		mySheet.Reset();
		mySheet.InitHeaders(headers,info);
		mySheet.InitColumns(cols);

	}

	function mySheet_OnResize() {
//		mySheet.FitColWidth();
	}
</script>

<body onload="LoadPage()">
        <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">헤더(Header)기능 > <b>헤더일반기능</b></span>
        </div>
                
        <div class="main_content">
            <div class="exp_product">
                헤더가 갖는 기본기능을 설정/확인한다. 
            </div>
        
            <div class="ib_function float_right">
                <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
                <a href="javascript:doAction('search')" class="f1_btn_white gray">조회</a>
            </div>

			<div class="clear hidden"></div>  
            
            <div class="ib_function2 border_sheet">
				<table class="ib_column2">
					<tr>
						<td><input class="checkbox" type="checkbox" checked="checked" id="sort"/></td>
						<td class="r20">소팅가능</td>
						<td><input class="checkbox" type="checkbox" checked="checked" id="move"/></td>
						<td class="r20">컬럼이동</td>
						<td><input class="checkbox" type="checkbox" checked="checked" id="size"/></td>
						<td class="r20">컬럼사이즈</td>
						<td><input class="checkbox" type="checkbox" checked="checked" id="check"/></td>
						<td class="r20">헤더체크</td>
						<td><a href="javascript:headFunc();" class="f2_btn_white btn_sheet">적용</a></td>
					 </tr>
				</table>
           </div>

			<p class="subtit_sheet">조회리스트</p>
            <div class="ib_product">
				<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
            </div>
        </div>
        <!--main_content-->

</body>
</html>








