<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />	
<link rel="stylesheet" href="../../css/style.css"/>
<script type="text/javascript" src="../js/common.js"></script>
<script language="javascript" src="../sheet/ibsheetinfo.js"></script>
<script language="javascript" src="../sheet/ibsheet.js"></script>
<title>IBSheet7-Product</title>

<script language="javascript">
	var pageheightoffset = 170;
/*Sheet 기본 설정 */
function LoadPage(){
	mySheet.SetConfig({MergeSheet:msHeaderOnly});
var cols = [
		{Type:"Status", Align:"Center"},
		{Type:"DelCheck", Align:"Center"},
		{Type:"Text", Width:245, TreeCol:1,LevelSaveName:"TREELEVEL",SaveName:"GuDong"},
		
		
		{Type:"Text", Width:65, Align:"Center",SaveName:"Zip1"},
		{Type:"Text", Width:65, Align:"Center",SaveName:"Zip2"},
		{Type:"Text", Width:65, Align:"Center",SaveName:"Zip3"},
		
		{Type:"Date", Width:100, Align:"Left"},
		{Type:"Date", Width:100, Align:"Left"}
		
		
	];
	
	var headers = [
		{Text:"상태|삭제|구/동|우편번호\n앞자리|우편번호뒷자리|우편번호뒷자리|등록일|최종변경일", Align:"Center"}
		,{Text:"상태|삭제|구/동|우편번호\n앞자리|시작|끝|등록일|최종변경일", Align:"Center"}
	];
	
	mySheet.InitHeaders(headers);
	mySheet.InitColumns(cols);
	mySheet.FitColWidth();
	mySheet.SetExtendLastCol(1);

}

function mySheet_OnTreeChild(Row){
	var str = mySheet.GetCellValue(Row,"GuDong");
	switch(str){
		case "중구":
		mySheet.DoSearchChild(Row, "append_tree_list1.jsp", "", 1);
		break;
		case "종로구":
		mySheet.DoSearchChild(Row, "append_tree_list2.jsp", "", 1);
		break;
		case "서대문구":
		mySheet.DoSearchChild(Row, "append_tree_list3.jsp", "", 1);
		break;
		case "마포구":
		mySheet.DoSearchChild(Row, "append_tree_list4.jsp", "", 1);
		break;
	}

}
function mySheet_OnClick(row,col,vv){
//		alert(sheet.IsHaveChild(row));
}	


/*Sheet 각종 처리*/
function doAction(sAction)
{
  switch(sAction)
  {
    case "Search":      //조회
      mySheet.DoSearch("append_tree_list.xml");
      break;
      
    case "reload":        //초기화
//    sheet.DataMove(7,4);
      mySheet.RemoveAll();
      break;

  }
}
</script>


</head>
<body onload="LoadPage()">
    <div class="page_title">
            <span><a class="closeDepth" href="#">closeDepth</a></span>
            <span class="title">트리(Tree) 기능 > <b>동적 확장 트리</b></span>
        </div>
                
        <div class="main_content">
            <div class="exp_product">
                자식노드를 펼칠때 데이터를 서버로 부터 가져온다.
            </div>
        
            <div class="ib_function float_right">
                <a href="javascript:doAction('reload')" class="f1_btn_gray lightgray">초기화</a>
                <a href="javascript:doAction('Search')" class="f1_btn_white gray">조회</a>
            </div>

			<div class="clear hidden"></div>  
            
            
           
			<p class="subtit_sheet">조회리스트</p>
            <div class="ib_product">
							<script type="text/javascript"> createIBSheet("mySheet", "100%", "100%"); </script>
            </div>
        </div>
        <!--main_content-->
</body>
</html>

